<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>A Contagem da Rosa â€” Final</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow-x: hidden;
  font-family: Inter, system-ui, sans-serif;
  background: radial-gradient(1200px 600px at 10% 10%, rgba(40,26,51,0.35), transparent),
              linear-gradient(180deg, #0a0a0c 0%, #1c2740 100%);
  color: #f6f5f8;
}
@supports (-webkit-touch-callout: none) {
  body { padding-bottom: env(safe-area-inset-bottom); }
}
.container {
  position: relative;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 28px 20px 80px;
}
h1 { margin: 0; font-size: 24px; text-align: center; }
main.grid {
  margin-top: 28px;
  width: 100%;
  max-width: 1100px;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 16px;
  align-items: stretch;
  justify-items: center;
}
.day {
  width: 100%; aspect-ratio: 1;
  border-radius: 14px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
  display: flex; align-items: center; justify-content: center; flex-direction: column;
  cursor: pointer; position: relative; overflow: hidden;
  box-shadow: 0 6px 18px rgba(2,6,23,0.6);
  transition: transform .3s, box-shadow .3s;
  animation: glowPulse 2.5s ease-in-out infinite;
}
@keyframes glowPulse {
  0% { box-shadow: 0 0 8px rgba(228,167,211,0.25); }
  50% { box-shadow: 0 0 18px rgba(228,167,211,0.45); }
  100% { box-shadow: 0 0 8px rgba(228,167,211,0.25); }
}
.circle {
  width: 64px; height: 64px; border-radius: 50%;
  background: rgba(40,26,51,0.7);
  display: flex; align-items: center; justify-content: center;
  font-weight: bold; font-size: 20px;
}
.modalBack {
  position: fixed; inset: 0;
  display: none; align-items: center; justify-content: center;
  background: rgba(0,0,0,0.6);
  z-index: 100; padding: 20px;
}
.modal {
  width: 100%; max-width: 600px; padding: 24px;
  border-radius: 14px;
  background: rgba(20,20,30,0.95);
  border: 1px solid #e4a7d3;
  box-shadow: 0 0 16px rgba(228,167,211,0.35);
}
.passwordBox input {
  width: 100%; padding: 12px;
  border-radius: 10px; border: none;
  margin-top: 10px; font-size: 16px;
}
.hintBox div {
  width: 100%; padding: 10px;
  border-radius: 8px;
  background: rgba(255,255,255,0.07);
  margin-top: 12px; min-height: 80px;
  font-size: 14px;
}
#snowCanvas { position: fixed; inset: 0; z-index: 5; pointer-events: none; }
#startMusic {
  position: fixed; bottom: 40px; right: 40px;
  padding: 16px 22px; border-radius: 16px;
  border: none; background: #e4a7d3; font-weight: bold;
  z-index: 200; font-size: 18px;
}
</style>
</head>
<body>
<canvas id="snowCanvas"></canvas>
<div class="container">
  <h1>ðŸŒ™ A Contagem da Rosa</h1>
  <main class="grid" id="grid"></main>
</div>

<div class="modalBack" id="modalBack">
  <div class="modal">
    <button id="closeModal" style="float:right;font-size:18px;background:none;border:none;color:#fff">âœ•</button>
    <h2 id="modalTitle"></h2>
    <p id="modalText"></p>

    <div class="passwordBox">
      <label>Senha do dia:</label>
      <input id="passwordInput" type="text" placeholder="Digite a senha" />
    </div>

    <div class="hintBox">
      <label>Dica do dia:</label>
      <div id="hintBox"></div>
    </div>

    <button id="confirmPassword" style="margin-top:14px;padding:10px 18px;border-radius:10px;border:none;background:#e4a7d3;color:#000;font-weight:bold">Confirmar</button>
  </div>
</div>

<audio id="bgMusic" src="music.mp3" preload="auto"></audio>
<button id="startMusic">â–¶ MÃºsica</button>

<script>
const days = [
  { index: 1, date: "2025-11-17", label: "17/11", text: "Mensagemâ€¦", password: "test1", hint: "Dica 1" },
  { index: 2, date: "2025-11-18", label: "18/11", text: "Mensagemâ€¦", password: "test2", hint: "Dica 2" },
  { index: 31, date: "2025-12-17", label: "17/12", text: "O GRANDE DIA", password: "vday", hint: "O presente final espera por vocÃªâ€¦" }
];

const grid = document.getElementById("grid");
days.forEach((d,i)=>{
  const box=document.createElement("div");
  box.className="day unlocked";
  box.dataset.i=i;
  box.innerHTML=`<div class='circle'>${d.index}</div>`;
  box.onclick=()=>openModal(i);
  grid.appendChild(box);
});

const modalBack=document.getElementById("modalBack");
const modalTitle=document.getElementById("modalTitle");
const modalText=document.getElementById("modalText");
const passwordInput=document.getElementById("passwordInput");
const confirmPassword=document.getElementById("confirmPassword");
const hintBox=document.getElementById("hintBox");

function openModal(i){
  const d=days[i];
  modalTitle.textContent=d.label;
  modalText.textContent=d.text;
  passwordInput.value="";
  hintBox.textContent=d.hint;

  confirmPassword.onclick=()=>{
    if(passwordInput.value.trim().toLowerCase()===d.password.toLowerCase()){
      alert("âœ” Senha correta!");
    } else alert("Senha incorreta!");
  };

  modalBack.style.display="flex";
}

document.getElementById("closeModal").onclick=()=>modalBack.style.display="none";

/* MÃºsica â€” versÃ£o FULL compatÃ­vel iPhone */
const bgMusic=document.getElementById("bgMusic");
const startMusic=document.getElementById("startMusic");
startMusic.addEventListener("click",()=>{
  bgMusic.play().then(()=>{
    startMusic.style.display="none";
  }).catch(e=>console.log(e));
});

/* Neve */
const snow=document.getElementById("snowCanvas");
const sctx=snow.getContext("2d");
let W,H,flakes=[];
function resize(){W=snow.width=innerWidth;H=snow.height=innerHeight;init();}
function init(){flakes=[];for(let i=0;i<150;i++)flakes.push({x:Math.random()*W,y:Math.random()*H,r:Math.random()*3+1,s:Math.random()*1+0.5});}
function draw(){
  sctx.clearRect(0,0,W,H);
  sctx.fillStyle="white";
  flakes.forEach(f=>{sctx.beginPath();sctx.arc(f.x,f.y,f.r,0,Math.PI*2);sctx.fill();f.y+=f.s;if(f.y>H)f